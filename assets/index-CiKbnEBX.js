import{r as i,j as s,M as P}from"./index-DGFiWo0n.js";import{C as L}from"./card-BumigV4P.js";import{u as T,T as _,S as r,s as G,a as B,D as U,M as F,A as K,g as V}from"./addTaskModal-yyK5AF8k.js";const $=({title:l,value:x,extraStyles:o=""})=>s.jsx("div",{className:`relative flex w-full min-w-[180px] rounded-[8px] border-l-3 md:w-[24%] ${o}`,children:s.jsx(L,{children:s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("span",{className:"capitalize",children:l?.replaceAll?.("_"," ")?.toLowerCase?.()}),s.jsx("span",{className:"text-3xl font-bold",children:x})]})})}),z=i.memo($),W=()=>{const{data:l,setData:x}=i.useContext(P),[o,p]=i.useState("ALL"),[f,n]=i.useState(l),[v,m]=i.useState(""),[E,u]=i.useState(!1),[c,N]=i.useState(""),[d,h]=i.useState(""),S=i.useCallback((t=l,e=c)=>[...t].filter(a=>a?.title?.toLowerCase?.()?.includes(e?.toLowerCase?.())),[l,c]),j=i.useCallback((t=l,e=d,a="asc")=>{const D=a==="desc"?-1:1;return[...t].sort((C,g)=>{if(e==="due_date")try{return(new Date(C?.[e])-new Date(g?.[e]))*D}catch(b){return console.error(b),0}else{const b=C?.[e]?.toString()?.toLowerCase?.()||"",R=g?.[e]?.toString()?.toLowerCase?.()||"";return b.localeCompare(R)*D}})},[l,d]),w=i.useMemo(()=>{let t={ALL:l?.length||0,PENDING:0,IN_PROGRESS:0,COMPLETED:0,OVERDUE:0};for(let e=0;e<l?.length;e++)t[l?.[e]?.status]>=0&&t[l?.[e]?.status]++;return t},[l]),y=i.useMemo(()=>{const t=S(l,c);let e={ALL:t?.length||0,PENDING:0,IN_PROGRESS:0,COMPLETED:0,OVERDUE:0};for(let a=0;a<t?.length;a++)e[t?.[a]?.status]>=0&&e[t?.[a]?.status]++;return e},[c,l]),A=T(t=>{const{value:e}=t?.target||{};if(N(e?.trim?.()),!e?.trim?.()){n([...l]),p(r?.ALL),h("");return}const a=S(l,e);n([...a]),p(r?.ALL),h("")},500),O=t=>{let e=[...l];switch(c&&(e=S([...e],c)),d&&(e=j([...e],d)),t){case r.ALL:n([...e]);break;case r.COMPLETED:n([...e?.filter(a=>a?.status===r?.COMPLETED)||[]]);break;case r.IN_PROGRESS:n([...e?.filter(a=>a?.status===r.IN_PROGRESS)||[]]);break;case r.OVERDUE:n([...e?.filter(a=>a?.status===r.OVERDUE)||[]]);break;case r.PENDING:n([...e?.filter(a=>a?.status===r.PENDING)||[]]);break;default:n([...e])}},M=t=>{let e=[...l];c?.trim()&&(e=S([...e],c)),t&&(e=j([...e],t)),o!==r.ALL&&(e=[...e].filter(a=>a?.status===o)),n([...e])},I=t=>{if(t?.id){x([...l].map(a=>a?.id===t?.id?t:a));let e=[...f].map(a=>a?.id===t?.id?t:a);o!==r.ALL&&(e=[...e].filter(a=>a?.status===o)),d&&(e=j([...e],d)),n(e)}else{const e=document?.getElementById("search-bar");e&&(e.value="");const a=[{...t,id:V()},...l];x(a),n(a),N(""),h(""),p(r?.ALL)}u(!1),m("")};return s.jsxs("div",{className:"flex w-full flex-1 flex-col gap-2 overflow-hidden",children:[s.jsx(_,{handleSearch:A,setOpenModal:u}),s.jsx(L,{className:"relative flex-1 overflow-y-auto",children:s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsx("span",{className:"text-2xl font-semibold",children:"Summary Dashboard"}),s.jsx("div",{className:"relative flex w-full flex-wrap justify-between gap-3",children:Object.entries(w)?.map(([t,e])=>t!==r?.ALL&&s.jsx(z,{title:t?.replaceAll?.("_"," ")?.toLowerCase?.(),value:e,extraStyles:G?.[t]?.border},t))})]}),s.jsxs("div",{className:"relative mt-3 flex flex-col gap-3",children:[s.jsx("span",{className:"text-2xl font-semibold",children:"Tasks"}),s.jsxs("div",{className:"sticky top-[-16px] z-[1] flex justify-between bg-white py-3",children:[s.jsx("div",{className:"flex flex-1 gap-1 overflow-x-auto",children:Object.entries(y)?.map(([t,e])=>s.jsx("button",{onClick:()=>{p(t),O(t)},className:`relative flex rounded-[4px] border border-gray-200 p-1 ${o===t&&"bg-blue-500 text-white"}`,children:s.jsxs("div",{className:"flex gap-1 text-xs whitespace-nowrap",children:[s.jsx("span",{className:"capitalize",children:t?.replaceAll?.("_"," ")?.toLowerCase?.()}),s.jsx("span",{className:"",children:`(${e})`})]})},t))}),s.jsx(B,{value:d,onChange:t=>{const{value:e}=t?.target||{};h(e),M(e)},options:[{displayValue:"Sort by",value:""},{displayValue:"Sort by due date",value:"due_date"},{displayValue:"Sort by name",value:"title"}]})]}),!!c&&s.jsxs("span",{className:"=text-sm font-bold",children:["Search result(",f?.length,")"]}),s.jsx("div",{className:"flex w-full flex-wrap justify-between gap-3",children:f?.length?f?.map(t=>s.jsx(U,{task:t,handleEditClick:()=>{m(t?.id),u(!0)},handleDeleteClick:()=>{x([...l].filter(e=>e?.id!==t?.id)),n([...f].filter(e=>e?.id!==t?.id))}},t?.id)):s.jsxs("div",{className:"flex h-50 w-full flex-col items-center justify-center gap-5",children:[s.jsx("span",{children:" No tasks available, please add one "}),s.jsx("button",{onClick:()=>{u(!0)},className:"flex items-center gap-1 rounded-[4px] bg-blue-500 px-2 py-1 font-semibold text-white",children:"+ Add task"})]})})]})]})}),s.jsx(F,{onClose:()=>{u(!1),m("")},isOpen:E,children:s.jsx(K,{handleAddButton:I,editTaskId:v,currentStatus:o,handleCancelModal:()=>{u(!1),m("")}})})]})};export{W as default};
